define("hyojun.fuzzy-finder/model",[],function(){function e(e,t){return t.some(function(t){return e.uid===t.uid})}function t(e){var t,i="";for(t in e)i+=t+":"+(e[t]&&"object"==typeof e[t]?e[t].val:e[t])+"^";return i}return{regexSuggestions:function(i,n,s){function r(n){var s,r,u=n[l].indexOf(i);if(-1!==u?(u=[i],r=1):h&&(u=n[l].match(h)),u&&"string"==typeof u[0]){if(s=u[0].toLowerCase(),r=r||i.length/s.length,.5>r)return;var a,c,d={};if("h"===l)a=n.h,c=a.toLowerCase().indexOf(s),d.t="url",d.h={val:a,match:[c,s.length]};else{var f;for(f in n)a=n[f],l===f?(c=a.toLowerCase().indexOf(s),d[f]={val:a,match:[c,s.length]}):d[f]=n[f]}d.uid=t(d),d.score=r,e(d,o)||o.push(d)}}var l="c";if(i.match(/^url\!/)&&(l="h",i=i.replace(/^url\!/,""),!i.length))return null;var h,o=[];try{h=new RegExp(i.split("").join(".*?"),"mgi")}catch(u){console.warn("malformed query: ",u),h=null}return n.map(function(e){s&&-1===s.indexOf(e.t)||r(e)}),o.sort(function(e,t){return e.score>t.score?-1:e.score<t.score?1:0})},levenstainSuggestions:function(){return[]}}}),define("hyojun.fuzzy-finder/view",[],function(){function e(e,t,i){var n=document.createElement(e);if(t&&"object"==typeof t)for(var s in t)void 0!==n[s]?n[s]=t[s]:n.setAttribute(s,t[s]);return"textContent"in n!==void 0&&(n.textContent="string"==typeof t?t:i||""),n}function t(t,i){var n=document.createElement("span");if("string"==typeof t)n=e("span",{className:i},t);else{n=document.createDocumentFragment();var s=t.match[0],r=t.match[1],l=t.val.substr(0,s),h=t.val.substr(s,r),o=t.val.substr(s+r,t.val.length);l.length&&n.appendChild(e("span",{className:i},l)),h.length&&n.appendChild(e("span",{className:"selection"},h)),o.length&&n.appendChild(e("span",{className:i},o))}return n.children?n:null}function i(i){if("object"==typeof i.c||"object"==typeof i.h){var n="url"===i.t,s=e("li"),r=e("a",{className:"item",href:i.h.val||i.h,target:"_blank","data-info":i.t||""}),l=t(n?i.h:i.c,"content");if(l&&s.appendChild(r).appendChild(l),n===!1){var h=t(i.h,"url");h&&s.appendChild(r).appendChild(h)}return s}return null}function n(e){var t=document.createDocumentFragment();return e.forEach(function(e){var n=i(e);n&&t.appendChild(n)}),t}var s=function(e){this.holderEle=e,this.result=[]};return s.prototype={clearResults:function(){for(;this.holderEle.children.length;)this.holderEle.children[0].onclick=null,this.holderEle.removeChild(this.holderEle.children[0]);this.holderEle.scrollTop=0,this.result=[],this.selectedItem=null},close:function(){this.selectedItem=null,this.holderEle.className=this.holderEle.className.replace(" active","")},setSelected:function(e){var t=this.holderEle.offsetHeight;this.selectedItem=null,this.result.forEach(function(i,n){if(n===e){if(this.selectedItem=i,-1===this.selectedItem.className.indexOf("hover")){this.selectedItem.className+=" hover";var s=this.selectedItem.offsetTop,r=this.selectedItem.offsetHeight;this.holderEle.scrollTop=s+r>t?s+r-t:0}}else i.className=i.className.replace(/\shover/gi,"")}.bind(this))},render:function(e){if(e.length){var t=n(e);this.holderEle.appendChild(t),this.result=Array.prototype.slice.call(this.holderEle.getElementsByTagName("li")),this.result.length&&-1===this.holderEle.className.indexOf("active")&&(this.holderEle.className+=" active")}}},s}),define("hyojun.fuzzy-finder/results-controller",[],function(){var e=function(e){this.view=e};return e.prototype={reset:function(){this.selectedIndex=-1,this.resultLength=0},refresh:function(){this.resultLength=this.view.result.length,this.selectedIndex=-1},check:function(e){return 27===e.keyCode&&this.view.selectedItem?(this.view.setSelected(-1),this.view.holderEle.scrollTop=0,this.refresh(),void e.stopImmediatePropagation()):e.keyCode&&-1!==[38,40].indexOf(e.keyCode)&&this.resultLength?(this.selectedIndex+=38===e.keyCode?-1:1,this.selectedIndex=Math.min(this.selectedIndex,this.resultLength-1),this.selectedIndex=Math.max(this.selectedIndex,0),this.view.setSelected(this.selectedIndex),void e.stopImmediatePropagation()):void 0},openSelected:function(){this.view&&this.view.selectedItem&&this.view.selectedItem.getElementsByTagName("a")[0].click()}},e}),define("hyojun.fuzzy-finder/controller",["hyojun.fuzzy-finder/model","hyojun.fuzzy-finder/view","hyojun.fuzzy-finder/results-controller"],function(e,t,i){var n=function(e,n,s){this.db=s,this.inputEle=e,this.timeout=0,this.view=new t(n),this.nav=new i(this.view),this.bindKeyboard()};return n.prototype={bindKeyboard:function(){this.inputEle.form.addEventListener("submit",this.checkQuery.bind(this),!1),this.inputEle.form.addEventListener("submit",this.nav.openSelected.bind(this.nav),!1),this.inputEle.addEventListener("keyup",this.nav.check.bind(this.nav),!1),this.inputEle.addEventListener("keyup",this.checkQuery.bind(this),!1)},checkQuery:function(e){if("submit"===e.type&&e.preventDefault(),27===e.keyCode&&this.nav.resultLength>0)return this.query=null,this.inputEle.value="",this.view.clearResults(),void this.closeView();if(!e.keyCode||-1===[16,18,93,91,18,17].indexOf(e.keyCode)){var t=this.inputEle.value;if(t.length<3)return void this.closeView();if(t!==this.query||!this.query){this.query=this.inputEle.value;var i=this.query.split(":")||[],n=i.pop();clearTimeout(this.timeout),n&&n.length>2&&(this.timeout=setTimeout(function(){this.getResult(n,i)}.bind(this),this.resultLength?800:500))}}},getResult:function(t,i){var n=(new Date).getTime(),s=e.regexSuggestions(t,this.db,i.length?i:null);n=(new Date).getTime()-n;var r=(new Date).getTime();s&&s.length?(this.view.clearResults(),this.view.render(s),this.nav.refresh()):(this.nav.reset(),this.closeView()),r=(new Date).getTime()-r,this.setQueryStatus("results:"+this.nav.resultLength+"/ query:"+n+"ms/ render:"+r+"ms")},closeView:function(){clearTimeout(this.timeout),this.nav.reset(),this.query=void 0,this.setQueryStatus(""),this.view.clearResults(),this.view.close()},setQueryStatus:function(e){this.inputEle.form.setAttribute("data-report",e)}},function(e){var t=document.getElementById("fuzzy-query"),i=document.getElementById("fuzzy-result");t&&i&&e?t.plugin=new n(t,i,e):console.warn("missing dependencies",t,i,e)}});